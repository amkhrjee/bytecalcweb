import{Scanner as e,Interpreter as t,Parser as s}from"./calculator.js";const r=document.querySelector(".output-display"),o=document.querySelector(".buttons"),l=document.querySelectorAll(".buttons>*"),n=document.querySelectorAll(".op-buttons>*"),c=document.querySelectorAll(".hidden-ops>md-filled-button"),a=document.querySelector(".numinput"),y=document.querySelector(".menu-btn"),i=document.querySelector(".output-display-wrapper>md-icon-button"),d=document.querySelector("md-filled-tonal-icon-button"),m=document.querySelector(".op-buttons"),u=document.querySelector(".hidden-ops"),p=document.querySelector(".display"),h=document.querySelector(".first-row"),f=document.querySelector(".menu"),b=document.querySelector(".support-btn"),v=document.querySelector(".support-dialog"),P=document.querySelector(".support-dialog-close-btn"),g=document.querySelector(".commit-date"),S=document.querySelector(".change-theme-btn"),k=document.querySelector(".theme-dialog"),E=document.querySelector(".theme-dialog-close-btn"),w=50;S.addEventListener("click",(()=>{k.open=!0,[p,h,u,o].forEach((e=>{e.style.opacity="1",e.style.filter="blur(0px)"})),f.style.transform="translateX(-70dvw)",setTimeout((()=>{f.style.visibility="hidden"}),100),q=!1})),fetch("https://api.github.com/repos/amkhrjee/bytecalcweb/commits?per_page=1").then((e=>e.json())).then((e=>{const t=e[0].commit.author.date,s=new Date(t).toLocaleString("en-GB",{day:"numeric",month:"short",year:"numeric"});g.innerHTML=s})).catch((e=>console.error(e))),b.addEventListener("click",(()=>{Haptics.vibrate(w),v.open=!0})),P.addEventListener("click",(()=>{Haptics.vibrate(w),v.open=!1})),E.addEventListener("click",(()=>{Haptics.vibrate(w),k.open=!1})),document.querySelector(".upi-payment").addEventListener("click",(()=>{navigator.clipboard.writeText("aniruddhamukherjee@fbl").then((()=>{alert("The UPI ID aniruddhamukherjee@fbl has been copied to your clipboard. You can open the UPI app of your choice, paste the UPI ID and pay to my UPI ID. Thanks for your support!")}))}));let q=!1;y.addEventListener("click",(()=>{Haptics.vibrate(w),q=!0,f.style.visibility="visible",f.style.transform="translateX(0)",[p,h,u,o].forEach((e=>{e.style.opacity="0.5",e.style.filter="blur(2px)"}))})),i.addEventListener("click",(()=>{Haptics.vibrate(w),navigator.clipboard.writeText(r.innerHTML).then((()=>{console.log("text added to clipboard")})).catch((()=>{console.error("could not add to the clipboard")}))}));let L=!1;d.addEventListener("click",(()=>{Haptics.vibrate(w),L?(m.style.transform="translateX(0)",d.style.transform="translateX(0)",u.style.transform="translateX(85dvw)",setTimeout((()=>{u.style.display="none"}),500),L=!1):(m.style.transform="translateX(-100dvw)",d.style.transform="translateX(-85dvw)",u.style.display="block",setTimeout((()=>{u.style.transform="translateX(0)"}),50),L=!0)}));let T=!1;const H=(e,t)=>{i.selected=!1,String(e).length<10?r.style.fontSize="2rem":r.style.fontSize="1.5rem",t?(r.style.color="var(--md-sys-color-error)",r.innerHTML=e):(r.style.color="var(--md-sys-color-on-secondary-container)",r.innerHTML=e,i.style.display="block")},I=()=>{a.value.length>=6&&a.value.length<=9?a.style.fontSize="4.5rem":a.value.length>9&&a.value.length<=12?a.style.fontSize="3.5rem":a.value.length>12&&(a.style.fontSize="2.5rem")},x=()=>{document.activeElement!==a&&a.focus()},M=e=>{const t=a.selectionStart,s=a.selectionEnd,r=a.value,o=r.substring(0,t)+e+r.substring(s);a.value=o;const l=t+e.length;a.setSelectionRange(l,l)};l.forEach((o=>{o.addEventListener("click",(()=>{Haptics.vibrate(w),o.style.borderRadius="10px",setTimeout((()=>{o.style.borderRadius="40px"}),200);const l=o.dataset.val;if(isNaN(parseInt(l))){if("backspace"===l)(()=>{const e=a.selectionStart,t=a.selectionEnd,s=a.value,r=s.substring(0,e-1)+s.substring(t);a.value=r;const o=e-1;a.setSelectionRange(o,o),i.style.display="none"})();else if("AC"===l)a.value="",a.style.fontSize="6rem",r.innerHTML="",i.style.display="none";else if("+"===l||"-"===l||"×"===l||"/"===l||"%"===l||"."===l)M(l);else if("parens"===l)T?(M(")"),T=!1):(M("("),T=!0);else if("="===l){let r=new e(a.value).scanTokens(),o=new s(r);try{let e=o.parse(),s=(new t).interpret(e);H(s.toString(),!1)}catch(e){H(e.message,!0)}}}else M(l);I(),x()}))})),n.forEach((e=>{e.addEventListener("click",(()=>{Haptics.vibrate(75);let t="";switch(e.dataset.val){case"log₂":M("log₂("),T=!0;break;case"2^":t="2^("+a.value+")",a.value=t;break;case"mod":M("mod");break;case"^":M("^")}I(),x()}))})),c.forEach((e=>{e.addEventListener("click",(()=>{Haptics.vibrate(w);const t=r.innerHTML.length&&"Empty Input"!=r.innerHTML?parseFloat(r.innerHTML):parseFloat(a.value);"bin"==e.dataset.val?t?(a.value="bin("+t+")",H(t.toString(2),!1),a.style.fontSize="3.5rem"):H("Empty Input",!0):"hex"==e.dataset.val&&(t?(a.value="hex("+t+")",H(t.toString(16),!1),a.style.fontSize="3.5rem"):H("Empty Input",!0))}))})),document.body.addEventListener("click",(e=>{e.target.closest(".menu")||e.target.closest(".menu-btn")||!q||([p,h,u,o].forEach((e=>{e.style.opacity="1",e.style.filter="blur(0px)"})),f.style.transform="translateX(-70dvw)",setTimeout((()=>{f.style.visibility="hidden"}),100),q=!1)}));const X=()=>{const e=document.documentElement;e.style.setProperty("--md-sys-color-primary","hsl(100, 55%, 27%)"),e.style.setProperty("--md-sys-color-primary-container","hsl(98, 79%, 77%)"),e.style.setProperty("--md-sys-color-on-primary","hsl(0, 0%, 100%)"),e.style.setProperty("--md-sys-color-secondary","hsl(95, 13%, 34%)"),e.style.setProperty("--md-sys-color-secondary-container","hsl(90, 37%, 85%)"),e.style.setProperty("--md-sys-color-on-secondary-container","hsl(100, 41%, 9%)"),e.style.setProperty("--md-sys-color-tertiary","hsl(180, 29%, 31%)"),e.style.setProperty("--md-sys-color-tertiary-container","hsl(181, 56%, 83%)"),e.style.setProperty("--md-sys-color-error","hsl(0, 75%, 42%)"),e.style.setProperty("--md-sys-color-error-container","hsl(6, 100%, 92%)"),e.style.setProperty("--md-sys-color-background","hsl(84, 29%, 90%)"),e.style.setProperty("--md-sys-color-on-surface","hsl(90, 8%, 10%)"),e.style.setProperty("--md-sys-color-on-surface-variant","hsl(90, 7%, 26%)"),e.style.setProperty("--md-sys-color-surface","hsl(84, 3%, 36%)"),e.style.setProperty("--md-sys-color-surface-bright","hsl(72, 50%, 96%)"),e.style.setProperty("--md-sys-color-surface-dim","hsl(72, 12%, 84%)"),e.style.setProperty("--md-sys-color-surface-container","hsl(72, 24%, 92%)"),e.style.setProperty("--md-sys-color-surface-container-lowest","hsl(0, 0%, 100%)"),e.style.setProperty("--md-sys-color-surface-container-low","hsl(72, 33%, 94%)"),e.style.setProperty("--md-sys-color-surface-container-high","hsl(72, 19%, 89%)"),e.style.setProperty("--md-sys-color-surface-container-highest","hsl(73, 14%, 87%)"),e.style.setProperty("--md-sys-color-outline","hsl(85, 5%, 45%)"),e.style.setProperty("--md-sys-color-outline-variant","hsl(83, 11%, 76%)")},z=()=>{const e=document.documentElement;e.style.setProperty("--md-sys-color-primary","hsl(98, 52%, 66%)"),e.style.setProperty("--md-sys-color-primary-container","hsl(99, 86%, 17%)"),e.style.setProperty("--md-sys-color-on-primary","hsl(101, 100%, 14%)"),e.style.setProperty("--md-sys-color-secondary","hsl(91, 21%, 74%)"),e.style.setProperty("--md-sys-color-secondary-container","hsl(94, 17%, 25%)"),e.style.setProperty("--md-sys-color-on-secondary-container","hsl(91, 21%, 74%)"),e.style.setProperty("--md-sys-color-tertiary","hsl(181, 34%, 72%)"),e.style.setProperty("--md-sys-color-tertiary-container","hsl(180, 44%, 21%)"),e.style.setProperty("--md-sys-color-error","hsl(6, 100%, 84%)"),e.style.setProperty("--md-sys-color-error-container","hsl(356, 100%, 29%)"),e.style.setProperty("--md-sys-color-background","hsl(84, 29%, 90%)"),e.style.setProperty("--md-sys-color-on-surface","hsl(60, 11%, 88%)"),e.style.setProperty("--md-sys-color-on-surface-variant","hsl(83, 11%, 76%)"),e.style.setProperty("--md-sys-color-surface","hsl(90, 18%, 7%)"),e.style.setProperty("--md-sys-color-surface-bright","hsl(86, 6%, 21%)"),e.style.setProperty("--md-sys-color-surface-dim","hsl(90, 18%, 7%)"),e.style.setProperty("--md-sys-color-surface-container","hsl(86, 12%, 12%)"),e.style.setProperty("--md-sys-color-surface-container-lowest","hsl(90, 25%, 5%)"),e.style.setProperty("--md-sys-color-surface-container-low","hsl(86, 14%, 10%)"),e.style.setProperty("--md-sys-color-surface-container-high","hsl(86, 9%, 15%)"),e.style.setProperty("--md-sys-color-surface-container-highest","hsl(86, 7%, 20%)"),e.style.setProperty("--md-sys-color-outline","hsl(85, 5%, 55%)"),e.style.setProperty("--md-sys-color-outline-variant","hsl(90, 7%, 26%)")};document.forms.theme.addEventListener("change",(e=>{console.log(e.target.value),console.log("In the form!");switch(e.target.value){case"light":X();break;case"dark":z();break;case"default":if(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches){z();break}X()}}));
